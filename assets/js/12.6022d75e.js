(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{230:function(t,a,s){"use strict";s.r(a);var e=s(2),n=Object(e.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"ids"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ids","aria-hidden":"true"}},[t._v("#")]),t._v(" Ids")]),t._v(" "),s("p",[t._v("In the last chapter about the API we saw that we'll have to provide a URI (or blank node) identifier when building a new resource with "),s("code",[t._v("Grax.build/2")]),t._v(". Minting an identifier for a new resource is a non-trivial step as these identifiers must be unique and (in most cases) persistent, i.e. should not change over the course of the lifetime of the resource. So, it would be good if the identifier creation logic wouldn't be scattered around the code base wherever we are building new resources. For this purpose, we can define the identifier creation logic in one central place with Grax id specs.\nA Grax id spec is a module which uses "),s("code",[t._v("Grax.Id.Spec")]),t._v(" macros to the define the overall identifier namespace structure and the specific rules for the creation of identifiers for the Grax schemas of our application.\nThis chapter explains the definition and use of those Grax id specs and enable you to implement common "),s("a",{attrs:{href:"https://patterns.dataincubator.org/book/identifier-patterns.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("identifier patterns"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("h2",{attrs:{id:"namespaces"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#namespaces","aria-hidden":"true"}},[t._v("#")]),t._v(" Namespaces")]),t._v(" "),s("p",[t._v("A Grax id spec module first has to "),s("code",[t._v("use Grax.Id.Spec")]),t._v(" to make the necessary macros available. With that, you can start to lay out the structure of the namespace the identifiers with the "),s("code",[t._v("namespace/1")]),t._v(" macro. It takes a string with a fragment of a URI and a "),s("code",[t._v("do")]),t._v(" block which consists of nested "),s("code",[t._v("namespace")]),t._v(" calls or definitions of id schemas, which we'll discuss later. The outermost "),s("code",[t._v("namespace")]),t._v(" call must be an absolute URI and can be given also a namespace vocabulary term instead of a string, while the nested namespaces just define a fragment string which will be concatenated to parent namespace.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n\n    namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bar#"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("This example defines three namespaces in which we can put our id schemas:")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("http://example.com/")])]),t._v(" "),s("li",[s("code",[t._v("http://example.com/foo/")])]),t._v(" "),s("li",[s("code",[t._v("http://example.com/bar#")])])]),t._v(" "),s("p",[t._v("You can also define an optional prefix for a namespace with the "),s("code",[t._v("prefix")]),t._v(" keyword argument on a "),s("code",[t._v("namespace")]),t._v(" call.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("prefix:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":foo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n\n    namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bar#"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("prefix:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":bar")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("The Grax id spec module provides a "),s("code",[t._v("prefix_map/0")]),t._v(" function which returns a "),s("code",[t._v("RDF.PrefixMap")]),t._v(" you can pass to the RDF serialization functions (see "),s("router-link",{attrs:{to:"/rdf-ex/serializations.html#managing-prefixes"}},[t._v("this section in the RDF.ex guide")]),t._v(" for more on this).")],1),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[t._v("iex"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prefix_map"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("%")]),t._v("RDF"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PrefixMap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("bar:")]),t._v(" ~I"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http:")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bar"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#>,")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("foo:")]),t._v(" ~I"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http:")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("foo"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(">\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("Unless you provide other prefixes on "),s("code",[t._v("Grax.to_rdf/1")]),t._v(" it will use this prefix map automatically to add them to the created graph, so that they in turn will be used on serialization.")]),t._v(" "),s("p",[t._v("The URI of one single namespace can be defined as the base URI by using the "),s("code",[t._v("base")]),t._v(" macro instead of the "),s("code",[t._v("namespace")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    base "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("prefix:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":foo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n\n    namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bar#"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("prefix:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":bar")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("The "),s("code",[t._v("base_iri/0")]),t._v(" function of the Grax id spec module will return the "),s("code",[t._v("RDF.IRI")]),t._v(" of this namespace.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[t._v("iex"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("base_iri"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n~I"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http:")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("foo"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(">\n")])])]),s("p",[t._v("As we will see later, namespaces can also act as containers for shared arguments of its id schemas, but let's introduce id schemas properly first.")]),t._v(" "),s("h2",{attrs:{id:"id-schemas"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#id-schemas","aria-hidden":"true"}},[t._v("#")]),t._v(" Id schemas")]),t._v(" "),s("p",[t._v("An id schema for a Grax schema can be defined in the most generic way with the "),s("code",[t._v("id_schema/2")]),t._v(" macro inside a "),s("code",[t._v("namespace")]),t._v(" block. It expects an URI template according to "),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/URI_Template",target:"_blank",rel:"noopener noreferrer"}},[t._v("RFC 6570"),s("OutboundLink")],1),t._v(" as the first argument and something to specify on which Grax schemas this id schema should be applied, most of the time by specifying the schema (or multiple schemas as a list) directly with the "),s("code",[t._v("schema")]),t._v(" keyword argument. You can use the properties of the Grax schema as parameters in the URI template.")]),t._v(" "),s("p",[t._v("Let's say we have a "),s("code",[t._v("Book")]),t._v(" Grax schema defined with an "),s("code",[t._v(":isbn")]),t._v(" property we'd like to use as the basis for its ids. We can define an id schema for the "),s("code",[t._v("Book")]),t._v(" schema like this:")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    id_schema "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"books/{isbn}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("schema:")]),t._v(" Book\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("As we've said, most of the time the Grax schema on which the id schema should be applied is given directly. For this form, the "),s("code",[t._v("id")]),t._v(" macro provides a more succinct but semantically equivalent form. So, the following is an equivalent definition of the same id schema:")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    id Book"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"books/{isbn}"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("For cases, where template consists solely of a template parameter with a property from the schema, an even shorter form is supported by the "),s("code",[t._v("id")]),t._v(" macro, where the property is written in the typical dot syntax after the schema. In our book example however, we don't have this simple template form, but we can get it simple into that form, by introducing a separate sub namespace, which might have been a good idea in the first place, since it allows us to define a prefix for this namespace.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"books/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("prefix:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":book")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n      id Book"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isbn\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("Again, this id schema will produce the same ids as the previous forms.")]),t._v(" "),s("p",[t._v("Before we look at more techniques to define id schemas, let's look at how we can use id schemas.")]),t._v(" "),s("h2",{attrs:{id:"using-id-schemas"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-id-schemas","aria-hidden":"true"}},[t._v("#")]),t._v(" Using id schemas")]),t._v(" "),s("p",[t._v("With the id schema we've created in the previous section a new book can now be build without having to provide an id:")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[t._v("iex"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Book"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("build!"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(">   "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("title:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Exploring Graphs with Elixir"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(">   "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("isbn:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1680508407"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("%")]),t._v("Book"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("__id__:")]),t._v(" ~I"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http:")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("books"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1680508407")]),t._v(">"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("title:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Exploring Graphs with Elixir"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("isbn:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1680508407"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("       \n")])])]),s("p",[t._v("This also makes it particularly easy to build nested graph structures, where we can provide linked resources just as a map (as long as everything is included to produce the ids). Let's suppose we also have an "),s("code",[t._v(":author")]),t._v(" link property in our "),s("code",[t._v("Book")]),t._v(" schema which links to an "),s("code",[t._v("Author")]),t._v(" schema with an id schema, which for the sake of simplicity is based on the name (although this is not a good idea in terms of uniqueness). This allows us to build a our book like this:")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[t._v("iex"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Book"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("build!"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(">   "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("title:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Exploring Graphs with Elixir"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(">   "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("isbn:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1680508407"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(">   "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("author:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("%")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("first_name:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Tony"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("last_name:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hammond"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("%")]),t._v("Book"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("__id__:")]),t._v(" ~I"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http:")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("books"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1680508407")]),t._v(">"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("title:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Exploring Graphs with Elixir"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("isbn:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1680508407"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("author:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("%")]),t._v("Author"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("__id__:")]),t._v(" ~I"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http:")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("authors"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Tony_Hammond"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("first_name:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Tony"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("last_name:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hammond"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("       \n")])])]),s("h2",{attrs:{id:"connecting-id-schemas-with-grax-schemas"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#connecting-id-schemas-with-grax-schemas","aria-hidden":"true"}},[t._v("#")]),t._v(" Connecting id schemas with Grax schemas")]),t._v(" "),s("p",[t._v("But how are Grax schemas and Grax id specs actually connected? How does Grax know in which id spec to search for an id schema?")]),t._v(" "),s("p",[t._v("The most direct option is to specify the "),s("code",[t._v("Grax.Id.Spec")]),t._v(" module on a Grax schema with the "),s("code",[t._v("id_spec")]),t._v(" keyword argument.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("div",{staticClass:"highlight-lines"},[s("br"),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br")]),s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Book "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id_spec:")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec\n  \n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("alias")]),t._v(" NS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SchemaOrg\n\n  schema SchemaOrg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Book "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    property "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":title")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" SchemaOrg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("required:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    property "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":isbn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" SchemaOrg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isbn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("required:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n\n    link "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":author")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" SchemaOrg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("author"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type:")]),t._v(" list_of"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Author"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("However, this won't be needed most of the time, since an application will usually have just one id spec for all Grax schemas. This id spec module can be configured with the "),s("code",[t._v(":grax_id_spec")]),t._v(" key under the configuration of your application. So, for an application with the name "),s("code",[t._v(":my_app")]),t._v(" this configuration would look like this:")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Mix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Config\n\nconfig "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":my_app")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("grax_id_spec:")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec\n")])])]),s("p",[t._v("For all Grax schemas defined in the "),s("code",[t._v(":my_app")]),t._v(" application the id spec module specified like this will be search for an id schema (unless another id spec module is specified directly with "),s("code",[t._v("id_spec")]),t._v(" keyword directly in the Grax schema).")]),t._v(" "),s("p",[t._v("For an id schema which directly specifies the Grax schema(s) on which it should be applied, finding the id spec is everything that's needed. The id schema with the matching Grax schema must be simply looked up. On a "),s("code",[t._v("build")]),t._v(" call the Grax schema is directly available (either the one passed to "),s("code",[t._v("Grax.build/2")]),t._v(" or the module on which we call the "),s("code",[t._v("build/1")]),t._v(" function). When the id generation is used to build nested Grax schemas the schema specified as the type of the link property is used for the lookup. For heterogenous properties however the schema is not determined, therefore the automatic building of nested Grax schemas is not supported on heterogenous links and you'll have to build and create the identifier for these manually.")]),t._v(" "),s("h3",{attrs:{id:"custom-schema-selectors"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#custom-schema-selectors","aria-hidden":"true"}},[t._v("#")]),t._v(" Custom schema selectors")]),t._v(" "),s("p",[t._v("Sometimes however we want to define an id schema for whole groups of classes. For example, think of Wikidata URIs, where we have just a few kinds of identifiers. In scenarios like these we don't want to have to enumerate all Grax schemas on an id schema. We can define a custom selector function instead with the "),s("code",[t._v(":selector")]),t._v(" keyword argument on the "),s("code",[t._v("id_schema")]),t._v(" macro (the "),s("code",[t._v("id")]),t._v(" macro works with directly given Grax schemas only). The function will be called with the Grax schema module and the map of key-value pairs which were passed on the "),s("code",[t._v("build")]),t._v(" function call. It is expected to return a boolean which signals if the id schema on this Grax schema with these values should be applied.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    id_schema "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"books/{isbn}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("selector:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":example_selector")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" example_selector"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Book"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" initial_values"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    IO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("inspect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("initial_values"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" example_selector"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("do:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("In this example we return "),s("code",[t._v("true")]),t._v(" for all "),s("code",[t._v("Book")]),t._v(" schema requests, making it essentially behave exactly like our previous examples. We just also output the second argument to demonstrate what else we have available to determine an id schema.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[t._v("iex"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Book"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("build!"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(">   "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("title:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Exploring Graphs with Elixir"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(">   "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("isbn:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1680508407"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("%")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("isbn:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1680508407"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("title:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Exploring Graphs with Elixir"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("%")]),t._v("Book"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("__id__:")]),t._v(" ~I"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http:")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("books"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1680508407")]),t._v(">"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("title:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Exploring Graphs with Elixir"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("isbn:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1680508407"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("       \n")])])]),s("h2",{attrs:{id:"custom-variables"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#custom-variables","aria-hidden":"true"}},[t._v("#")]),t._v(" Custom variables")]),t._v(" "),s("p",[t._v("Obviously, we will not always have a property available to use in our templates. Either we need to process an existing property value or there are template parameters which are completely independent of the properties of a Grax schema. For these situations we can define a variable processing or generating function and associate it with our id schema via the "),s("code",[t._v("var_mapping")]),t._v(" keyword argument. This function will receive a map of all properties and their values and is expected to return an "),s("code",[t._v(":ok")]),t._v(" tuple with an updated map which should be used to resolve the variable in the URI template.")]),t._v(" "),s("p",[t._v("Let's say we want to use the slugified title our our "),s("code",[t._v("Post")]),t._v(" schema from the previous chapters.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    id Post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"posts/{slug}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("var_mapping:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":slugify_title")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" slugify_title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("%")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("title:")]),t._v(" title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vars"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":ok")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n      Map"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("put"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vars"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":slug")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n           title\n           "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|>")]),t._v(" to_string"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n           "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|>")]),t._v(" String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("downcase"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n           "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|>")]),t._v(" String"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("replace"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" slugify_title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"missing :title value for URI generation"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("The passed variables map will also include a special "),s("code",[t._v(":__schema__")]),t._v(" value with Grax schema for which the id is requested. This can be very useful when the id schema is used for multiple Grax schemas. You can then pattern match on the "),s("code",[t._v(":__schema__")]),t._v(" field and provide different variable processing logic for the different Grax schemas.")]),t._v(" "),s("h2",{attrs:{id:"auto-incremented-counters"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#auto-incremented-counters","aria-hidden":"true"}},[t._v("#")]),t._v(" Auto-incremented counters")]),t._v(" "),s("p",[t._v("If you want to base the ids of a schema on an auto-incremented counter, you can do so by defining a counter on your id schema with the "),s("code",[t._v("counter")]),t._v(" keyword argument, which will define a persistent counter with the given name. Every time a new instance of a schema is created with the "),s("code",[t._v("build")]),t._v(" functions this counter will be automatically increased. You can include the value of the counter in your URI templates with the "),s("code",[t._v("counter")]),t._v(" variable.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n      id Post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"posts/{counter}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("counter:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":posts")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[t._v("iex"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("build"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("title:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Foo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("%")]),t._v("Post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("__id__:")]),t._v(" ~I"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http:")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("posts"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(">"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("author:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("title:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Foo"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\niex"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("build"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("title:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Bar"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("%")]),t._v("Post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("__id__:")]),t._v(" ~I"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http:")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("posts"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(">"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("author:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("title:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Bar"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("The abbreviated dot operator syntax when the template consists of a variable only is also supported for the counter variable:")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"posts/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("prefix:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":post")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n      id Post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("counter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("counter:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":posts")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("  \n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("You can also share the same counter between different schemas just by using the same name on the "),s("code",[t._v("counter")]),t._v(" keyword argument, for example to define Wikidata-like id schemas with counters for different categories of classes.")]),t._v(" "),s("p",[t._v("By default the counters are persisted in DETS tables, each in dedicated files with the name of the counter accordingly. The path where these are stored can be configured with the "),s("code",[t._v("counter_dir")]),t._v(" option in your Mix config (default is the current directory):")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Mix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Config\n\nconfig "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":grax")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("counter_dir:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"example/counters/"')]),t._v("\n")])])]),s("p",[t._v("When you want to use a completely different way to manage and store your counters, you can define your own by implementing the "),s("code",[t._v("Grax.Id.Counter.Adapter")]),t._v(" behaviour. The default adapter we've been using above is the "),s("code",[t._v("Grax.Id.Counter.Dets")]),t._v(" implementation. An alternative implementation which simple stores a counter in a text file is available with "),s("code",[t._v("Grax.Id.Counter.TextFile")]),t._v(". This implementation however shouldn't be used in production. It just serves as a reference implementation and is only useful in tests or very simple scenarios.")]),t._v(" "),s("p",[t._v("Another adapter can be set on an individual id schema with the "),s("code",[t._v("counter_adapter")]),t._v(" keyword argument.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"posts/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("prefix:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":post")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n      id Post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("counter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("counter:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":posts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("counter_adapter:")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Counter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TextFile\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("An adapter can also be set as the default counter adapter with the "),s("code",[t._v("counter_adapter")]),t._v(" keyword either on a namespace or for a whole id spec on the "),s("code",[t._v("use Grax.Id.Spec")]),t._v(" call.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("counter_adapter:")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Counter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TextFile\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("counter_adapter:")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Counter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Dets "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"posts/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("prefix:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":post")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n      id Post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("counter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("counter:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":posts")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("h2",{attrs:{id:"hash-ids"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hash-ids","aria-hidden":"true"}},[t._v("#")]),t._v(" Hash ids")]),t._v(" "),s("p",[t._v("If you want to base your identifiers on cryptographic hashes, you can use the "),s("code",[t._v("hash")]),t._v(" macro from the "),s("code",[t._v("Grax.Id.Hash")]),t._v(" extension. It works as a replacement for the "),s("code",[t._v("id")]),t._v(" macro and provides an additional "),s("code",[t._v("hash")]),t._v(" variable for use in the template given with the "),s("code",[t._v(":template")]),t._v(" keyword argument. The property from which the hash is computed is given with the "),s("code",[t._v(":data")]),t._v(" keyword argument and the hashing algorithm must be specified with the "),s("code",[t._v(":algorithm")]),t._v(" argument. The names of the algorithms are passed down to Erlang hash function, so please refer to the "),s("a",{attrs:{href:"https://erlang.org/doc/man/crypto.html#type-hash_algorithm",target:"_blank",rel:"noopener noreferrer"}},[t._v("Erlang documentation"),s("OutboundLink")],1),t._v(" of your version, for which ones are available.")]),t._v(" "),s("p",[t._v("Let's use our "),s("code",[t._v("Post")]),t._v(" schema from the last chapters as an example again.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hash\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    hash Post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("template:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"posts/{hash}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("data:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("algorithm:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":sha256")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("There are various ways this can be shortened. First, we can introduce again an additional namespace for "),s("code",[t._v("posts/")]),t._v(", so that the "),s("code",[t._v("template")]),t._v(" would become "),s("code",[t._v('"{hash}"')]),t._v(", which we can omit, since it is the default template used in the "),s("code",[t._v("hash")]),t._v(" macro.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hash\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n      hash Post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("data:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("algorithm:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":sha256")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("Next, instead of providing the property with the data for the hashing input with the "),s("code",[t._v(":data")]),t._v(" keyword argument, it can be given with the dot operator after the schema.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hash\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n      hash Post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("algorithm:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":sha256")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("If all hash identifiers inside of a namespace should use the same algorithm we can also specify the hash algorithm on the respective namespace with the "),s("code",[t._v(":hash_algorithm")]),t._v(" keyword argument.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hash\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("hash_algorithm:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":sha256")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n      hash Post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("When the same hash algorithm should be used throughout the whole id spec, the "),s("code",[t._v(":hash_algorithm")]),t._v(" can also specified on the "),s("code",[t._v("use Grax.Id.Spec")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("hash_algorithm:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":sha256")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hash\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n      hash Post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("All these outer scope "),s("code",[t._v(":hash_algorithm")]),t._v(" specifications can be overwritten in inner scopes including the id schema itself.")]),t._v(" "),s("h2",{attrs:{id:"uuids"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#uuids","aria-hidden":"true"}},[t._v("#")]),t._v(" UUIDs")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("Grax.Id.UUID")]),t._v(" extension provides macros for defining UUID id schemas. The most generic one is the "),s("code",[t._v("uuid")]),t._v(" macros and has the following keyword arguments:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v(":version")]),t._v(": the version of the UUIDs to be generated; it can be 1, 3, 4 or 5 and is required")]),t._v(" "),s("li",[s("code",[t._v(":format")]),t._v(": the format of the UUIDs to be generated; it can be "),s("code",[t._v(":default")]),t._v(" (which also is the default if not specified) or "),s("code",[t._v(":hex")]),t._v(")")]),t._v(" "),s("li",[s("code",[t._v(":namespace")]),t._v(": the namespace to be used for name-based UUIDs of version 3 and 5; it can be "),s("code",[t._v(":url")]),t._v(", "),s("code",[t._v(":dns")]),t._v(", "),s("code",[t._v(":oid")]),t._v(", , "),s("code",[t._v(":x500")]),t._v(", "),s("code",[t._v(":nil")]),t._v(" or another UUID as a string and is required when "),s("code",[t._v(":version")]),t._v(" is 3 or 5")]),t._v(" "),s("li",[s("code",[t._v(":name_var")]),t._v(": the name of the property of the Grax schema whose value should be used as the basis for the name for which the UUID will be generated; required when "),s("code",[t._v(":version")]),t._v(" is 3 or 5")])]),t._v(" "),s("p",[t._v("The generated is available with the "),s("code",[t._v("uuid")]),t._v(" variable for the template in the "),s("code",[t._v(":template")]),t._v(" keyword argument.")]),t._v(" "),s("p",[t._v("We're using our schemas from the last chapters as an example again to demonstrate this.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UUID\n\n  "),s("span",{pre:!0,attrs:{class:"token attribute variable"}},[t._v("@custom_uuid_namespace")]),t._v(" UUID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("uuid5"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":dns")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"example.domain.com"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    uuid User"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("template:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{uuid}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("version:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("format:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":hex")]),t._v("\n    uuid Comment"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n      "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("template:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{uuid}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n      "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("version:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n      "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("namespace:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attribute variable"}},[t._v("@custom_uuid_namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n      "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name_var:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("format:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":hex")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("We can apply all of the techniques we saw in the previous sections to make everything more compact.")]),t._v(" "),s("ol",[s("li",[t._v("We can omit the template when it just consists solely of the "),s("code",[t._v("uuid")]),t._v(" variable.")]),t._v(" "),s("li",[t._v("For the name-based UUIDs in version 3 and 5 we can provide the property for the "),s("code",[t._v(":name_var")]),t._v(" with the dot operator after the schema.")]),t._v(" "),s("li",[t._v("We can move shared arguments to the namespace by using the equivalent keyword argument just prefixed with the extension name.")]),t._v(" "),s("li",[t._v("There are also dedicated macros for the different versions available, which make the "),s("code",[t._v(":version")]),t._v(" argument implicit.")])]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" Example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IdSpec "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UUID\n\n  "),s("span",{pre:!0,attrs:{class:"token attribute variable"}},[t._v("@custom_uuid_namespace")]),t._v(" UUID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("uuid5"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":dns")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"example.domain.com"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  namespace "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("uuid_format:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":hex")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    uuid4 User\n    uuid5 Comment"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("namespace:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attribute variable"}},[t._v("@custom_uuid_namespace")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("h2",{attrs:{id:"urns"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#urns","aria-hidden":"true"}},[t._v("#")]),t._v(" URNs")]),t._v(" "),s("p",[t._v("Grax id schemas for URN identifiers can be defined by using any of the macros for the definition of id schemas, but putting them in special URN namespaces. These namespaces can be defined with the "),s("code",[t._v("urn")]),t._v(" macro and get a symbol for the namespace identifier instead of a path fragment. The colons before and after the namespace identifier are added automatically, so you won't have to add them in the template.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" UrnIds "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n\n  urn "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":example")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    id User"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{name}"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n\n  urn "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":uuid")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    uuid4 Post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n\n  urn "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":sha1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("algorithm:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token atom symbol"}},[t._v(":sha")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    hash Post"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("Note, that in the case of the UUID URNs the URN format will be automatically selected. This format is only available in the URN namespaces.")]),t._v(" "),s("h2",{attrs:{id:"blank-nodes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#blank-nodes","aria-hidden":"true"}},[t._v("#")]),t._v(" Blank nodes")]),t._v(" "),s("p",[t._v("Grax schemas which should have blank nodes as identifiers can be declared with the "),s("code",[t._v("blank_node")]),t._v(" macro in an id spec. It just takes a single Grax schema or a list of Grax schemas as the only argument")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("defmodule")]),t._v(" UrnIds "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" Grax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Spec\n\n  blank_node Address\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("p",[t._v("The generated blank nodes ids will be underscored UUIDs.")]),t._v(" "),s("div",{staticClass:"language-elixir extra-class"},[s("pre",{pre:!0,attrs:{class:"language-elixir"}},[s("code",[t._v("iex"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Address"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("build!"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(">   "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("street:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Marienstraße 11"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(">   "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("city:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Berlin"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("%")]),t._v("Address"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("__id__:")]),t._v(" ~B"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("_07456224d1074c87a1152f75319593ef"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("street:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Marienstraße 11"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("city:")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Berlin"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("   \n")])])])])},[],!1,null,null,null);a.default=n.exports}}]);